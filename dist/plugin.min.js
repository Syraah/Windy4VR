const t={name:"windy-plugin-windy4vr",version:"1.0.7",title:"Windy4VR",icon:"ðŸ¥•",description:"Plugin windy pour visualiser son routage virtuel",author:"Syraah",repository:"https://github.com/Syraah/Windy4VR",desktopUI:"rhpane",mobileUI:"small",desktopWidth:400,routerPath:"/windy4vr",built:1736009018475,builtReadable:"2025-01-04T16:43:38.475Z"},{map:e}=W.map,l=W.store,{wind2obj:n}=W.utils,{getLatLonInterpolator:o}=W.interpolator,a=W.metrics,r=W.broadcast;function s(){}function i(t){return t()}function c(){return Object.create(null)}function d(t){t.forEach(i)}function u(t){return"function"==typeof t}function g(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function h(t,e){t.appendChild(e)}function p(t,e,l){const n=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!n.getElementById(e)){const t=x("style");t.id=e,t.textContent=l,function(t,e){h(t.head||t,e),e.sheet}(n,t)}}function f(t,e,l){t.insertBefore(e,l||null)}function v(t){t.parentNode&&t.parentNode.removeChild(t)}function m(t,e){for(let l=0;l<t.length;l+=1)t[l]&&t[l].d(e)}function x(t){return document.createElement(t)}function y(t){return document.createTextNode(t)}function w(){return y(" ")}function C(t,e,l,n){return t.addEventListener(e,l,n),()=>t.removeEventListener(e,l,n)}function b(t,e,l){null==l?t.removeAttribute(e):t.getAttribute(e)!==l&&t.setAttribute(e,l)}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function S(t,e,l,n){null==l?t.style.removeProperty(e):t.style.setProperty(e,l,"")}let A;function k(t){A=t}function F(){if(!A)throw new Error("Function called outside component initialization");return A}const T=[],O=[];let G=[];const E=[],_=Promise.resolve();let D=!1;function N(t){G.push(t)}const M=new Set;let I=0;function P(){if(0!==I)return;const t=A;do{try{for(;I<T.length;){const t=T[I];I++,k(t),q(t.$$)}}catch(t){throw T.length=0,I=0,t}for(k(null),T.length=0,I=0;O.length;)O.pop()();for(let t=0;t<G.length;t+=1){const e=G[t];M.has(e)||(M.add(e),e())}G.length=0}while(T.length);for(;E.length;)E.pop()();D=!1,M.clear(),k(t)}function q(t){if(null!==t.fragment){t.update(),d(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(N)}}const R=new Set;function j(t){return void 0!==t?.length?t:Array.from(t)}function z(t,e){const l=t.$$;null!==l.fragment&&(!function(t){const e=[],l=[];G.forEach((n=>-1===t.indexOf(n)?e.push(n):l.push(n))),l.forEach((t=>t())),G=e}(l.after_update),d(l.on_destroy),l.fragment&&l.fragment.d(e),l.on_destroy=l.fragment=null,l.ctx=[])}function Z(t,e){-1===t.$$.dirty[0]&&(T.push(t),D||(D=!0,_.then(P)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function B(t,e,l,n,o,a,r=null,g=[-1]){const h=A;k(t);const p=t.$$={fragment:null,ctx:[],props:a,update:s,not_equal:o,bound:c(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:c(),dirty:g,skip_bound:!1,root:e.target||h.$$.root};r&&r(p.root);let f=!1;if(p.ctx=l?l(t,e.props||{},((e,l,...n)=>{const a=n.length?n[0]:l;return p.ctx&&o(p.ctx[e],p.ctx[e]=a)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](a),f&&Z(t,e)),l})):[],p.update(),f=!0,d(p.before_update),p.fragment=!!n&&n(p.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);p.fragment&&p.fragment.l(t),t.forEach(v)}else p.fragment&&p.fragment.c();e.intro&&((m=t.$$.fragment)&&m.i&&(R.delete(m),m.i(x))),function(t,e,l){const{fragment:n,after_update:o}=t.$$;n&&n.m(e,l),N((()=>{const e=t.$$.on_mount.map(i).filter(u);t.$$.on_destroy?t.$$.on_destroy.push(...e):d(e),t.$$.on_mount=[]})),o.forEach(N)}(t,e.target,e.anchor),P()}var m,x;k(h)}class H{$$=void 0;$$set=void 0;$destroy(){z(this,1),this.$destroy=s}$on(t,e){if(!u(e))return s;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(e),()=>{const t=l.indexOf(e);-1!==t&&l.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function U(t){p(t,"svelte-xsvoth",".ZE.svelte-xsvoth.svelte-xsvoth{margin-top:20px}table.svelte-xsvoth.svelte-xsvoth{width:100%;border-collapse:collapse;margin-top:20px}th.svelte-xsvoth.svelte-xsvoth,td.svelte-xsvoth.svelte-xsvoth{border:1px solid #ddd;padding:8px}th.svelte-xsvoth.svelte-xsvoth{background-color:#f4f4f4;text-align:left;color:#4d4d4d}td.svelte-xsvoth div.svelte-xsvoth{display:inline-block;border:1px solid #000}.add-button.svelte-xsvoth.svelte-xsvoth{display:inline-block;width:30px;height:30px;border-radius:50%;background-color:#f4f4f4;color:#0056b3;font-size:24px;font-weight:bold;text-align:center;line-height:20px;cursor:pointer;border:none;box-shadow:0 4px 6px rgba(0, 0, 0, 0.2)}.add-button.svelte-xsvoth.svelte-xsvoth:hover{background-color:#0056b3;color:white}.delete-button.svelte-xsvoth.svelte-xsvoth{display:inline-block;width:30px;height:30px;border-radius:50%;background-color:transparent;color:#e63939;font-size:24px;text-align:center;line-height:20px;cursor:pointer;border:none}.delete-button.svelte-xsvoth.svelte-xsvoth:hover{background-color:#e63939;color:#f4f4f4;font-weight:bold}.delete-cell.svelte-xsvoth.svelte-xsvoth{border:none;text-align:center;padding:0;background-color:transparent}")}function V(t,e,l){const n=t.slice();return n[41]=e[l],n[43]=l,n}function X(t,e,l){const n=t.slice();return n[44]=e[l],n[43]=l,n}function Y(t){let e,l,n,o,a;return{c(){e=x("p"),e.textContent="SÃ©lectionnez un(des) fichier(s) GPX pour afficher la trace sur la map.",l=w(),n=x("input"),b(n,"type","file"),b(n,"accept",".gpx,.csv"),n.multiple=!0},m(r,s){f(r,e,s),f(r,l,s),f(r,n,s),o||(a=C(n,"change",t[5]),o=!0)},p:s,d(t){t&&(v(e),v(l),v(n)),o=!1,a()}}}function J(t){let e,l,n,o,a,r,s,i,c,u,g,p,$,L,A,k,W,F,T,O,G,E,_,D,N,M,I,P,q,R=j(t[4]),z=[];for(let e=0;e<R.length;e+=1)z[e]=et(X(t,R,e));let Z=j(t[1]),B=[];for(let e=0;e<Z.length;e+=1)B[e]=lt(V(t,Z,e));return{c(){e=x("h3"),e.textContent="Windy Data:",l=w(),n=x("table"),o=x("thead"),o.innerHTML='<tr><th class="svelte-xsvoth">Route</th> <th class="svelte-xsvoth">TWS</th> <th class="svelte-xsvoth">TWD</th> <th class="svelte-xsvoth">TWA</th> <th class="delete-cell svelte-xsvoth"></th></tr>',a=w(),r=x("tbody");for(let t=0;t<z.length;t+=1)z[t].c();s=w(),i=x("h3"),i.textContent="GPX Waypoint details",c=w(),u=x("table"),g=x("thead"),g.innerHTML='<tr><th class="svelte-xsvoth">Route</th> <th class="svelte-xsvoth">HDG</th> <th class="svelte-xsvoth">Speed</th> <th class="svelte-xsvoth">TWS</th> <th class="svelte-xsvoth">TWA</th> <th class="svelte-xsvoth">Sail</th></tr>',p=w(),$=x("tbody");for(let t=0;t<B.length;t+=1)B[t].c();L=w(),A=x("br"),k=w(),W=x("label"),F=x("button"),F.textContent="+",T=y("\r\n\t\tAjouter une route"),O=w(),G=x("input"),E=w(),_=x("label"),D=x("br"),N=x("input"),M=y(" Zones d'exclusion VG2024"),I=x("br"),b(n,"class","svelte-xsvoth"),b(u,"class","svelte-xsvoth"),b(F,"class","add-button svelte-xsvoth"),b(F,"id","addFileButton"),b(G,"type","file"),b(G,"id","fileInput"),b(G,"accept",".csv,.gpx"),S(G,"display","none"),G.multiple=!0,b(N,"class","ZE svelte-xsvoth"),b(N,"type","checkbox")},m(d,v){f(d,e,v),f(d,l,v),f(d,n,v),h(n,o),h(n,a),h(n,r);for(let t=0;t<z.length;t+=1)z[t]&&z[t].m(r,null);f(d,s,v),f(d,i,v),f(d,c,v),f(d,u,v),h(u,g),h(u,p),h(u,$);for(let t=0;t<B.length;t+=1)B[t]&&B[t].m($,null);f(d,L,v),f(d,A,v),f(d,k,v),f(d,W,v),h(W,F),h(W,T),f(d,O,v),f(d,G,v),f(d,E,v),f(d,_,v),h(_,D),h(_,N),h(_,M),h(_,I),P||(q=[C(F,"click",t[9]),C(G,"change",t[5]),C(N,"click",t[7])],P=!0)},p(t,e){if(85&e[0]){let l;for(R=j(t[4]),l=0;l<R.length;l+=1){const n=X(t,R,l);z[l]?z[l].p(n,e):(z[l]=et(n),z[l].c(),z[l].m(r,null))}for(;l<z.length;l+=1)z[l].d(1);z.length=R.length}if(3&e[0]){let l;for(Z=j(t[1]),l=0;l<Z.length;l+=1){const n=V(t,Z,l);B[l]?B[l].p(n,e):(B[l]=lt(n),B[l].c(),B[l].m($,null))}for(;l<B.length;l+=1)B[l].d(1);B.length=Z.length}},d(t){t&&(v(e),v(l),v(n),v(s),v(i),v(c),v(u),v(L),v(A),v(k),v(W),v(O),v(G),v(E),v(_)),m(z,t),m(B,t),P=!1,d(q)}}}function K(t){let e,l=t[44].windSpeed+"";return{c(){e=y(l)},m(t,l){f(t,e,l)},p(t,n){16&n[0]&&l!==(l=t[44].windSpeed+"")&&$(e,l)},d(t){t&&v(e)}}}function Q(t){let e,l,n=t[44].windDir+"";return{c(){e=y(n),l=y("Â°")},m(t,n){f(t,e,n),f(t,l,n)},p(t,l){16&l[0]&&n!==(n=t[44].windDir+"")&&$(e,n)},d(t){t&&(v(e),v(l))}}}function tt(t){let e,l,n=t[44].TWA+"";return{c(){e=y(n),l=y("Â°")},m(t,n){f(t,e,n),f(t,l,n)},p(t,l){16&l[0]&&n!==(n=t[44].TWA+"")&&$(e,n)},d(t){t&&(v(e),v(l))}}}function et(t){let e,l,n,o,a,r,s,i,c,d,u,g,p,m,y,$,L=!t[2]&&K(t),A=!t[2]&&Q(t),k=!t[2]&&tt(t);function W(){return t[8](t[43])}return{c(){e=x("tr"),l=x("td"),n=x("div"),a=w(),r=x("td"),L&&L.c(),s=w(),i=x("td"),A&&A.c(),c=w(),d=x("td"),k&&k.c(),u=w(),g=x("td"),p=x("button"),p.textContent="â€“",m=w(),S(n,"width","20px"),S(n,"height","20px"),S(n,"background-color",t[0][t[43]].color),b(n,"title",o=t[0][t[43]].fileName),b(n,"class","svelte-xsvoth"),b(l,"class","svelte-xsvoth"),b(r,"class","svelte-xsvoth"),b(i,"class","svelte-xsvoth"),b(d,"class","svelte-xsvoth"),b(p,"class","delete-button svelte-xsvoth"),b(p,"id","deletefile"),b(p,"title","Supprimer la route"),b(g,"class","delete-cell svelte-xsvoth")},m(t,o){f(t,e,o),h(e,l),h(l,n),h(e,a),h(e,r),L&&L.m(r,null),h(e,s),h(e,i),A&&A.m(i,null),h(e,c),h(e,d),k&&k.m(d,null),h(e,u),h(e,g),h(g,p),h(e,m),y||($=C(p,"click",W),y=!0)},p(e,l){t=e,1&l[0]&&S(n,"background-color",t[0][t[43]].color),1&l[0]&&o!==(o=t[0][t[43]].fileName)&&b(n,"title",o),t[2]?L&&(L.d(1),L=null):L?L.p(t,l):(L=K(t),L.c(),L.m(r,null)),t[2]?A&&(A.d(1),A=null):A?A.p(t,l):(A=Q(t),A.c(),A.m(i,null)),t[2]?k&&(k.d(1),k=null):k?k.p(t,l):(k=tt(t),k.c(),k.m(d,null))},d(t){t&&v(e),L&&L.d(),A&&A.d(),k&&k.d(),y=!1,$()}}}function lt(t){let e,l,n,o,a,r,s,i,c,d,u,g,p,m,C,L,A,k,W,F,T,O,G,E,_=(t[41].COG||"N/A")+"",D=(t[41].SOG||"N/A")+"",N=(t[41].TWS||"N/A")+"",M=(t[41].TWA||"N/A")+"",I=(t[41].SAIL||"N/A")+"";return{c(){e=x("tr"),l=x("td"),n=x("div"),a=w(),r=x("td"),s=y(_),i=y("Â°"),c=w(),d=x("td"),u=y(D),g=y(" nds"),p=w(),m=x("td"),C=y(N),L=y(" nds"),A=w(),k=x("td"),W=y(M),F=y("Â°"),T=w(),O=x("td"),G=y(I),E=w(),S(n,"width","20px"),S(n,"height","20px"),S(n,"background-color",t[0][t[43]].color),b(n,"title",o=t[0][t[43]].fileName),b(n,"class","svelte-xsvoth"),b(l,"class","svelte-xsvoth"),b(r,"class","svelte-xsvoth"),b(d,"class","svelte-xsvoth"),b(m,"class","svelte-xsvoth"),b(k,"class","svelte-xsvoth"),b(O,"class","svelte-xsvoth")},m(t,o){f(t,e,o),h(e,l),h(l,n),h(e,a),h(e,r),h(r,s),h(r,i),h(e,c),h(e,d),h(d,u),h(d,g),h(e,p),h(e,m),h(m,C),h(m,L),h(e,A),h(e,k),h(k,W),h(k,F),h(e,T),h(e,O),h(O,G),h(e,E)},p(t,e){1&e[0]&&S(n,"background-color",t[0][t[43]].color),1&e[0]&&o!==(o=t[0][t[43]].fileName)&&b(n,"title",o),2&e[0]&&_!==(_=(t[41].COG||"N/A")+"")&&$(s,_),2&e[0]&&D!==(D=(t[41].SOG||"N/A")+"")&&$(u,D),2&e[0]&&N!==(N=(t[41].TWS||"N/A")+"")&&$(C,N),2&e[0]&&M!==(M=(t[41].TWA||"N/A")+"")&&$(W,M),2&e[0]&&I!==(I=(t[41].SAIL||"N/A")+"")&&$(G,I)},d(t){t&&v(e)}}}function nt(t){let e,l,n,o,a=!t[3]&&Y(t),r=t[0].length>0&&J(t);return{c(){e=x("section"),l=x("div"),l.textContent="Windy4VR",n=w(),a&&a.c(),o=w(),r&&r.c(),b(l,"class","plugin__title"),b(e,"class","plugin__content")},m(t,s){f(t,e,s),h(e,l),h(e,n),a&&a.m(e,null),h(e,o),r&&r.m(e,null)},p(t,l){t[3]?a&&(a.d(1),a=null):a?a.p(t,l):(a=Y(t),a.c(),a.m(e,o)),t[0].length>0?r?r.p(t,l):(r=J(t),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i:s,o:s,d(t){t&&v(e),a&&a.d(),r&&r.d()}}}function ot(t){return new Promise(((e,l)=>{const n=new FileReader;n.onload=t=>e(t.target.result),n.onerror=t=>l(t),n.readAsText(t)}))}function at(t,e){const[l,n]=t.split("/"),[o,a]=n.split(" ");return new Date(`${e}-${o}-${l}T${a}`)}function rt(t,e){let l=(t-e+360)%360;return l>180&&(l-=360),Math.round(l)}function st(t,e,l,n){const o=t=>t*Math.PI/180,a=o(t),r=o(l),s=o(n-e),i=Math.sin(s)*Math.cos(r),c=Math.cos(a)*Math.sin(r)-Math.sin(a)*Math.cos(r)*Math.cos(s);let d=180*Math.atan2(i,c)/Math.PI;return Math.round((d+360)%360)}function it(t,s,i){let c=[],d=[],u=[],g=[],h=!1;new Date(l.get("timestamp")).toLocaleString();let p=!1,f=[],v=[],m=null,x=[],y=[],w=[],C="",b=!1,$=0;const S='<svg  viewBox="0 0 14 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;"><path d="M4.784,13.635c0,0 -0.106,-2.924 0.006,-4.379c0.115,-1.502 0.318,-3.151 0.686,-4.632c0.163,-0.654 0.45,-1.623 0.755,-2.44c0.202,-0.54 0.407,-1.021 0.554,-1.352c0.038,-0.085 0.122,-0.139 0.215,-0.139c0.092,0 0.176,0.054 0.214,0.139c0.151,0.342 0.361,0.835 0.555,1.352c0.305,0.817 0.592,1.786 0.755,2.44c0.368,1.481 0.571,3.13 0.686,4.632c0.112,1.455 0.006,4.379 0.006,4.379l-4.432,0Z" style="fill:#000;"/><path d="M5.481,12.731c0,0 -0.073,-3.048 0.003,-4.22c0.06,-0.909 0.886,-3.522 1.293,-4.764c0.03,-0.098 0.121,-0.165 0.223,-0.165c0.103,0 0.193,0.067 0.224,0.164c0.406,1.243 1.232,3.856 1.292,4.765c0.076,1.172 0.003,4.22 0.003,4.22l-3.038,0Z" style="fill:#fff;fill-opacity:0.846008;"/></svg>',A='<svg xmlns="http://www.w3.org/2000/svg" viewBox="-23.6626 -11.6643 10.13 31.78" width="12px" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">\n\t<path d="M -13.6675 17.5876 C -13.5859 17.5005 -13.5395 17.386 -13.5377 17.2667 C -13.5377 17.2667 -13.5272 16.724 -13.5656 16.0588 C -13.6038 15.3939 -13.673 14.6183 -13.9117 14.0237 C -14.3916 12.828 -15.0129 12.1904 -16.2213 10.9823 L -16.3619 10.8417 C -16.0511 10.7066 -15.7589 10.5416 -15.5067 10.3259 C -14.886 9.7949 -14.4958 8.9926 -14.5561 8.0627 C -14.7854 4.5287 -15.0472 -0.203 -15.6672 -3.3076 C -16.1591 -5.7715 -17.1428 -10.6992 -17.1428 -10.6992 C -17.2542 -11.2578 -17.7505 -11.6645 -18.3201 -11.6643 H -18.5402 C -19.0775 -11.6642 -19.5537 -11.303 -19.6977 -10.7853 C -19.6977 -10.7853 -20.5206 -7.8271 -20.932 -6.3478 C -22.2827 -1.4909 -22.9811 3.2939 -22.9831 8.7733 C -22.9835 9.7617 -22.2964 10.4539 -21.5352 10.8124 C -21.2793 10.9325 -21.0113 11.0166 -20.7424 11.0855 L -20.9784 11.3215 C -22.1992 12.5423 -22.5107 13.0302 -22.9419 14.0089 C -23.2162 14.6316 -23.378 15.489 -23.4921 16.2218 S -23.6605 17.5543 -23.6605 17.5543 C -23.685 17.8183 -23.4908 18.0521 -23.2268 18.0765 C -23.0843 18.0898 -22.9434 18.0388 -22.8424 17.9374 L -20.3365 15.4316 L -18.8861 19.7856 C -18.8024 20.0372 -18.5307 20.1733 -18.2792 20.0896 C -18.123 20.0377 -18.0042 19.9094 -17.9646 19.7497 L -16.8125 15.1425 L -14.3571 17.5979 C -14.1697 17.7855 -13.8657 17.7856 -13.6782 17.5982 C -13.6746 17.5946 -13.671 17.591 -13.6676 17.5872 L -13.6675 17.5875 Z" fill="#000"/>\n\t<path d="M -16.1217 9.6048 C -16.5451 9.967 -17.177 10.1998 -17.8745 10.2332 L -19.2508 10.2994 C -19.7879 10.3246 -20.55 10.2189 -21.1136 9.9534 C -21.6784 9.6873 -22.01 9.3516 -22.0098 8.7813 C -22.0096 8.1371 -21.9988 7.504 -21.9794 6.8788 L -18.7655 6.8788 C -18.6357 6.8802 -18.511 6.829 -18.4195 6.7369 C -18.2328 6.5486 -18.234 6.2447 -18.4221 6.058 C -18.5133 5.9674 -18.637 5.9173 -18.7656 5.9187 L -21.9342 5.9188 C -21.8203 3.5442 -21.5678 1.2848 -21.172 -0.9291 C -21.1618 -0.9284 -21.1517 -0.9284 -21.1415 -0.9284 L -19.1051 -0.9284 C -18.9753 -0.9269 -18.8505 -0.9781 -18.759 -1.0703 C -18.5724 -1.2585 -18.5736 -1.5625 -18.7618 -1.7492 C -18.853 -1.8396 -18.9766 -1.8897 -19.105 -1.8884 L -20.9878 -1.8883 C -20.7102 -3.2906 -20.3837 -4.6829 -19.9947 -6.0819 C -19.5832 -7.5614 -18.7591 -10.5207 -18.7591 -10.5207 C -18.7297 -10.6276 -18.6374 -10.6968 -18.527 -10.6971 H -18.307 C -18.1888 -10.6971 -18.0934 -10.6197 -18.0711 -10.5034 C -18.0711 -10.5034 -17.5648 -7.9675 -17.1642 -5.9611 L -18.4264 -5.9611 C -18.6915 -5.9658 -18.9102 -5.7548 -18.9149 -5.4897 S -18.7086 -5.0059 -18.4435 -5.0011 C -18.4378 -5.001 -18.4322 -5.001 -18.4264 -5.0011 H -17.0688 C -17.0373 -5.0012 -17.006 -5.0044 -16.9751 -5.0106 C -16.8088 -4.1779 -16.7222 -3.7449 -16.5958 -3.112 C -16.3051 -1.6557 -16.0927 0.2287 -15.9237 2.1847 L -18.4268 2.1846 C -18.6919 2.1799 -18.9106 2.391 -18.9153 2.6561 S -18.709 3.1399 -18.4439 3.1446 C -18.4382 3.1448 -18.4325 3.1448 -18.4268 3.1446 L -15.8521 3.1446 C -15.7169 4.8625 -15.6002 6.6192 -15.5021 8.1324 C -15.4602 8.7772 -15.6955 9.2433 -16.1186 9.6055 L -16.1217 9.6048 Z" fill="#FF6A00"/>\n\t<path d="M -14.5307 16.0663 L -16.7329 13.8641 C -16.9963 13.6008 -17.4461 13.7246 -17.5377 14.0855 L -18.4963 17.9185 L -19.6724 14.3905 C -19.7857 14.053 -20.2144 13.952 -20.4665 14.2036 L -22.5136 16.2506 C -22.4034 15.5786 -22.2434 14.8026 -22.0641 14.3957 C -21.6483 13.4515 -21.4939 13.1944 -20.2995 11.9999 L -19.5479 11.2482 C -18.8589 11.2623 -18.0949 11.1913 -17.4239 11.1369 C -17.2503 11.3105 -17.0742 11.4865 -16.8999 11.6608 C -15.6929 12.8676 -15.2253 13.3354 -14.8025 14.3815 C -14.6634 14.7278 -14.569 15.4528 -14.5307 16.0666 L -14.5308 16.0663 Z" fill="#0F0"/>\n</svg>';let k=S,T=!0;const O=[[{lat:43.523333,lng:-10.086667},{lat:43.35,lng:-9.606667},{lat:43.175,lng:-9.733333},{lat:42.88,lng:-9.733333},{lat:42.88,lng:-10.230833},{lat:43.315833,lng:-10.230833}],[{lat:38.866667,lng:-9.685},{lat:38.661667,lng:-9.666667},{lat:38.565,lng:-10.195},{lat:38.681667,lng:-10.23},{lat:38.866667,lng:-10.23}],[{lat:37.041667,lng:-9.195},{lat:36.945,lng:-9.171667},{lat:36.858333,lng:-9.071667},{lat:36.835,lng:-8.953333},{lat:36.42,lng:-9.1},{lat:36.474333,lng:-9.36},{lat:36.736667,lng:-9.664583},{lat:36.943333,lng:-9.721667}],[{lat:28.33,lng:-14.795},{lat:27.813,lng:-15.005833},{lat:27.858333,lng:-15.1475},{lat:28.341667,lng:-14.951667}],[{lat:28.563333,lng:-15.655},{lat:27.973333,lng:-16.215833},{lat:28.0575,lng:-16.3275},{lat:28.635,lng:-15.78}],[{lat:21.516667,lng:-16.416667},{lat:16,lng:-16.416667},{lat:16,lng:-17.583333},{lat:21.516667,lng:-17.583333}],[{lat:-21.5,lng:-39.75},{lat:-21.933333,lng:-39.233333},{lat:-23,lng:-40.220833},{lat:-23.5775,lng:-41.015},{lat:-23.483333,lng:-41.633333},{lat:-22.133333,lng:-40.416667}],[{lat:-24.9,lng:-42.85},{lat:-25.5,lng:-42.263333},{lat:-25.916667,lng:-43.333333},{lat:-25.505833,lng:-43.75}],[{lat:40.9,lng:-28.566667},{lat:37.81,lng:-23.833333},{lat:36.626667,lng:-24.216667},{lat:36.34,lng:-25.593333},{lat:37.583333,lng:-31.856667},{lat:40,lng:-31.833333}],[{lat:17.75,lng:-25.35},{lat:17.7,lng:-22.666667},{lat:15.966667,lng:-22.133333},{lat:14.533333,lng:-22.833333},{lat:14.666667,lng:-25.416667},{lat:16.166667,lng:-26.133333}],[{lat:49.7675,lng:-6.275833},{lat:49.592333,lng:-6.273333},{lat:49.5925,lng:-6.568333},{lat:49.767167,lng:-6.4925}],[{lat:49.034167,lng:-5.611667},{lat:48.81,lng:-5.416667},{lat:48.62,lng:-5.1975},{lat:48.489167,lng:-5.3675},{lat:48.583333,lng:-5.708333},{lat:48.708333,lng:-6.051667},{lat:48.94,lng:-5.86}],[{lat:46.952167,lng:-2.526667},{lat:46.848583,lng:-2.404333},{lat:46.800417,lng:-2.491083},{lat:46.884583,lng:-2.590583},{lat:46.916083,lng:-2.59175}],[{lat:-44,lng:0},{lat:-44.25,lng:5},{lat:-44.8333,lng:10},{lat:-45.4167,lng:15},{lat:-46,lng:20},{lat:-46.75,lng:25},{lat:-47.5,lng:30},{lat:-47.75,lng:35},{lat:-48,lng:40},{lat:-48.75,lng:45},{lat:-49.3333,lng:50},{lat:-49.8333,lng:55},{lat:-50.25,lng:60},{lat:-50.5833,lng:65},{lat:-50.9167,lng:70},{lat:-50.9167,lng:75},{lat:-50.6667,lng:80},{lat:-50.4167,lng:85},{lat:-50,lng:90},{lat:-49,lng:95},{lat:-46,lng:100},{lat:-46,lng:105},{lat:-46,lng:110},{lat:-46,lng:115},{lat:-49,lng:120},{lat:-49.75,lng:125},{lat:-50,lng:130},{lat:-50,lng:135},{lat:-50,lng:140},{lat:-50,lng:145},{lat:-50,lng:150},{lat:-56.0833,lng:155},{lat:-56.3333,lng:160},{lat:-56.5,lng:165},{lat:-56.6667,lng:170},{lat:-57.3333,lng:175},{lat:-58,lng:180},{lat:-80,lng:180},{lat:-80,lng:-175},{lat:-58.25,lng:-175},{lat:-58.25,lng:-170},{lat:-58,lng:-165},{lat:-57.25,lng:-160},{lat:-56.5,lng:-155},{lat:-55.75,lng:-150},{lat:-55,lng:-145},{lat:-54.25,lng:-140},{lat:-54,lng:-135},{lat:-54.25,lng:-130},{lat:-54.75,lng:-125},{lat:-55.25,lng:-120},{lat:-55.75,lng:-115},{lat:-57.5,lng:-110},{lat:-58.25,lng:-105},{lat:-58.8333,lng:-100},{lat:-59.1667,lng:-95},{lat:-59.5,lng:-90},{lat:-59.6667,lng:-85},{lat:-59.5,lng:-80},{lat:-59.25,lng:-75},{lat:-58.75,lng:-70},{lat:-58,lng:-65},{lat:-56.5,lng:-60},{lat:-54,lng:-55},{lat:-45,lng:-50},{lat:-44,lng:-45},{lat:-44,lng:-40},{lat:-44,lng:-35},{lat:-43.5,lng:-30},{lat:-43,lng:-25},{lat:-43,lng:-20},{lat:-43,lng:-15},{lat:-43,lng:-10},{lat:-43.5,lng:-5}]];function G(){if(void 0===l)return void console.error("Windy store is not available.");let t=l.get("timestamp");l.get("product"),l.on("timestamp",(e=>{const l=new Date(e);e!==t&&(t=e,N(l),M())})),l.on("product",(t=>{M()})),console.log("Plugin initialized and listening for timestamp changes.")}function E(t){return new Promise(((e,l)=>{const n=new FileReader;n.onload=t=>{const l=t.target.result.split("\n").map((t=>t.trim())).filter((t=>t.length>0)),n=l[0].split(";"),o=l.slice(1).map((t=>{const e=t.split(";");return n.reduce(((t,l,n)=>(t[l]=e[n],t)),{})}));C=function(t){return t.includes("Date")&&t.includes("Latitude")&&t.includes("Longitude")?"Avalon":t.includes("position")&&t.includes("time")&&t.includes("sog")?"Dorado":"Unknown"}(n),e(o)},n.onerror=t=>l(t),n.readAsText(t)}))}function _(t){var e=[];if("Avalon"==C){let l=(new Date).getFullYear(),n=null;e=t.map((t=>{const e=t.Date;let o=at(e,l);return n&&o<n&&(l++,o=at(e,l)),n=o,{time:o,lat:parseFloat(t.Latitude),lon:parseFloat(t.Longitude),COG:parseFloat(t.Heading),SOG:parseFloat(t.Speed),SAIL:t.SailSet,TWA:parseFloat(t.TWA),TWD:parseFloat(t.TWD),TWS:parseFloat(t.TWS)}}))}else"Dorado"==C&&(e=t.map((t=>{const[e,l]=t.position.split("  ").map((t=>function(t){const e=t.match(/(\d+)[^\d]+([\d.]+)\s*([NSEW])/i);if(!e)throw new Error(`CoordonnÃ©e invalide : ${t}`);const l=parseFloat(e[1]),n=parseFloat(e[2]),o=e[3].toUpperCase();let a=l+n/60;return"S"!==o&&"W"!==o||(a=-a),a}(t.trim())));return{lat:e,lon:l,time:new Date(t.time),SOG:parseFloat(t.sog),TWS:parseFloat(t.TWS),TWD:parseFloat(t.TWD),SOG:parseFloat(t["current speed"]),COG:parseFloat(t["current dir."])}})));for(let t=0;t<e.length-1;t++){var l=e[t];if(0==l.COG){var n=e[t+1],o=st(l.lat,l.lon,n.lat,n.lon);e[t].COG=o}}return e[e.length-1].COG=e[e.length-2].COG,e}function D(t){const e=(new DOMParser).parseFromString(t,"application/xml"),l=e.querySelectorAll("wpt"),n=e.querySelectorAll("rtept");if(0==l.length){const t=[];n.forEach((e=>{const l=parseFloat(e.getAttribute("lat")),n=parseFloat(e.getAttribute("lon"))>0?parseFloat(e.getAttribute("lon"))%360-360:parseFloat(e.getAttribute("lon")),o=e.querySelector("time")?.textContent||null,a=o?new Date(o):null,r=e.querySelector("name")?.textContent||"Unknown";t.push({lat:l,lon:n,time:a,name:r})}));for(let e=0;e<t.length-1;e++){var o=t[e],a=t[e+1],r=st(o.lat,o.lon,a.lat,a.lon);t[e].COG=r}return t[t.length-1].COG=t[t.length-2].COG,t}{const t=e.querySelector("desc")?.textContent;if(!t)return{error:"No desc tag found"};const n=function(t){const e=/COG = ([\d,.]+).+ SOG = ([\d,.]+)nds TWS = ([\d,.]+)nds TWA = ([\d.,]+).+ SAIL = ([\w-]*)/,l=/HDG:(\d+)\s+TWA:([-\d.,]+)\s+(.+?)\s+SOG:([\d.,]+)\s+kt\s+TWS:([\d.,]+)\s+kt/;return e.test(t)?(m=e,1):l.test(t)?(m=l,2):(console.error("format de fichier incompatible"),0)}(t),s=[];l.forEach((t=>{const e=parseFloat(t.getAttribute("lat")),l=parseFloat(t.getAttribute("lon"))>0?parseFloat(t.getAttribute("lon"))%360-360:parseFloat(t.getAttribute("lon")),o=parseFloat(t.querySelector("ele")?.textContent||"0"),a=t.querySelector("time")?.textContent||null,r=a?new Date(a):null,i=t.querySelector("name")?.textContent||"Unknown",c=(t.querySelector("desc")?.textContent||"").match(m);1==n?s.push({lat:e,lon:l,ele:o,time:r,name:i,COG:c?parseFloat(c[1].replace(",",".")):null,SOG:c?parseFloat(c[2].replace(",",".")):null,TWS:c?parseFloat(c[3].replace(",",".")):null,TWA:c?parseFloat(c[4].replace(",",".")):null,SAIL:c?c[5]:null}):2==n&&null!=c&&s.push({lat:e,lon:l,ele:o,time:r,name:i,COG:c[1],SOG:c[4],TWS:c[5],TWA:c[2],SAIL:c[3]})}));for(let t=0;t<s.length-1;t++){if(0==(o=s[t]).COG){a=s[t+1],r=st(o.lat,o.lon,a.lat,a.lon);s[t].COG=r,console.log(r)}}return s[s.length-1].COG=s[s.length-2].COG,s}}function N(t){var e=0;i(1,u=function(t){var e=[];return c.forEach((l=>{var n=l.waypoints[0];let o=Math.abs(t-n.time);l.waypoints.forEach((e=>{const l=Math.abs(t-e.time);l<o&&(o=l,n=e)})),e.push(n)})),e}(t)),g.forEach((t=>{u&&(t.setLatLng([u[e].lat,u[e].lon]),t.setIcon(L.divIcon({className:"marker-icon",html:`<div style="transform: rotate(${u[e].COG}deg);">${k}</div>`,iconSize:[24,24],iconAnchor:[12,12]})),e++)}))}async function M(){i(2,h=!0);const t=r.once("redrawFinished",(async()=>{i(4,v=[]);for(const t of u){const[e,r]=[t.lat,t.lon];try{const s=await o();if(!s){console.error("No interpolator available for this overlay");continue}if("wind"!==l.get("overlay")){console.error("Please select the wind overlay to interpolate wind values.");continue}const i=s({lat:e,lon:r});if(Array.isArray(i)){const{dir:e,wind:l}=n(i),o=a.wind.convertValue(l," "),r=e,s=rt(e,t.COG);v.push({windSpeed:o,windDir:r,TWA:s})}else console.error("Invalid wind data:",i)}catch(t){console.error("Error processing waypoint:",t)}}i(2,h=!1),r.off(t)}))}function I(t){if(console.log("Deleting route ",t),f.length>1){e.removeLayer(f[t]),e.removeLayer(g[t]),e.removeLayer(d[t]),d.forEach((l=>{l.i==t&&e.removeLayer(l.markerWP)})),c.splice(t,1),u.splice(t,1),f.splice(t,1),g.splice(t,1),v.splice(t,1),y.splice(t,1),d.splice(t,1),x.splice(t,1);for(let e=d.length-1;e>=0;e--)d[e].i==t?d.splice(e,1):d[e].i>t&&d[e].i--;i(0,c=[...c])}else P()}function P(){f.forEach((t=>{e.removeLayer(t)})),g.forEach((t=>{e.removeLayer(t)})),d.forEach((t=>{e.removeLayer(t.markerWP)})),i(3,p=!1),x=[],i(0,c=[]),i(1,u=[]),f=[],g=[],i(2,h=!1),new Date(l.get("timestamp")).toLocaleString(),i(3,p=!1),i(4,v=[]),y=[],w=[],d=[]}var q;q=()=>{},F().$$.on_mount.push(q),function(t){F().$$.on_destroy.push(t)}((()=>{P()})),"undefined"!=typeof W&&void 0!==l?G():(alert("pas init"),document.addEventListener("windyLoaded",G));return[c,u,h,p,v,async function(t){const n=Array.from(t.target.files);i(3,p=!0),n.length;for(const t of n)if(-1==x.indexOf(t.name))try{const e=t.name.split(".").pop().toLowerCase();$=($+60)%360;const l=`hsl(${$}, 100%, 45%)`;var o=[];if("csv"===e){const e=await E(t);o=await _(e)}else if("gpx"===e){o=D(await ot(t))}else console.error("Unsupported file type:",t.name),alert("Type de fichier non pris en charge. Veuillez charger un fichier .csv ou .gpx.");i(0,c=[...c,{fileName:t.name,waypoints:o,ploted:!1,color:l}]),x.push(t.name)}catch(t){console.error("Error reading file:",t)}else alert(`Le fichier "${t.name}" est dÃ©jÃ  prÃ©sent.`);var a;a=0,c.forEach(((t,n)=>{if(!t.ploted){const o=t.waypoints,r=t.color,s=o.map((t=>[t.lat,t.lon])),h=L.polyline(s,{color:r,weight:2,opacity:.5}).addTo(e);f.push(h),o.forEach((t=>{const n=t.time.getTime(),o=new L.marker([t.lat,parseFloat(t.lon)>0?parseFloat(t.lon)%360-360:parseFloat(t.lon)],{icon:L.divIcon({className:"marker-icon",html:`<div><svg width="4" height="4" version="1.1" xmlns="http://www.w3.org/2000/svg"><circle cx="2" cy="2" r="2" fill="${r}" stroke-width="0"/></svg></div>`,iconSize:[4,4],iconAnchor:[2,12],opacity:1})});o.on("click",(()=>l.set("timestamp",n))),o.addTo(e),d.push({markerWP:o,i:a})}));const p=o[0];u.push(p);const v=new L.marker([p.lat,parseFloat(p.lon)>0?parseFloat(p.lon)%360-360:parseFloat(p.lon)],{icon:L.divIcon({className:"marker-icon",html:`<div style="transform: rotate(${p.COG}deg);">${k}</div>`,iconSize:[24,24],iconAnchor:[12,12]})});v.on("click",(()=>(T?(k=A,T=!1):(k=S,T=!0),void N(l.get("timestamp"))))),v.addTo(e),g.push(v),e.fitBounds(h.getBounds()),M(),i(0,c[n].ploted=!0,c)}a++})),N(new Date(l.get("timestamp")))},I,function(){b?(w.forEach((t=>{e.removeLayer(t)})),b=!1):(Object.entries(O).forEach((([t,l])=>{var n=L.polygon(l,{color:"red"}).addTo(e);w.push(n)})),b=!0)},t=>I(t),()=>document.getElementById("fileInput").click()]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");class ct extends H{constructor(t){super(),B(this,t,it,nt,g,{},U,[-1,-1])}}export{t as __pluginConfig,ct as default};
